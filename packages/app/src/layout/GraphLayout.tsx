import { useContext } from "react";
import { Button } from "@radix-ui/themes";
import { LuArrowLeftFromLine } from "react-icons/lu";
import { ThemeContext } from "../contexts/ThemeContext";
import { Link, useLocation, useParams } from "react-router";

export default function GraphLayout(props: {
  sideBarSlot?: React.ReactNode;
  graphSlot: React.ReactNode;
}) {
  const themeContext = useContext(ThemeContext);
  const location = useLocation();
  const { file } = useParams();
  const isBaseAuditView = file === undefined;
  console.log(location.pathname)

  return (
    <div className="h-screen grow flex gap-3 bg-background-light text-text-light dark:bg-background-dark dark:text-text-dark px-4 py-3">
      {props.sideBarSlot && (
        <div className="flex flex-col gap-2 bg-secondaryBackground-light dark:bg-secondaryBackground-dark rounded-xl px-2 py-2">
          {props.sideBarSlot}
        </div>
      )}
      <div className="flex flex-col flex-1 min-w-0 transition-all duration-300 ease-in-out">
        <div className={`bg-secondaryBackground-light dark:bg-secondaryBackground-dark rounded-xl rounded-b-none flex items-center px-2 py-2 ${isBaseAuditView ? 'justify-end' : 'justify-between'}`}>
          <div className={`flex items-center space-x-10 ${isBaseAuditView ? 'hidden' : ''}`}>
            <Link to="/audit">
              <Button radius="large" variant="ghost" size="3" className="flex space-x-2 ml-1">
                <LuArrowLeftFromLine className="" />
                <span className="">Back</span>
              </Button>
            </Link>
            <h1 className="text-md font-semibold text-gray-500 dark:text-text-dark">
              { file }
            </h1>
          </div>
          <div className="flex gap-4 border border-secondarySurface-light dark:border-secondarySurface-dark px-3 py-2 rounded-xl">
            <Button
              variant="ghost"
              size="1"
              onClick={() => themeContext.changeTheme("light")}
              className={`p-2.5 rounded-md ${
                themeContext.theme === "light"
                  ? "bg-secondarySurface-light"
                  : ""
              }`}
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
                className="text-gray-light dark:text-gray-dark"
                fill="currentColor"
              >
                <path d="M10 14.1667C7.7 14.1667 5.83333 12.3 5.83333 10C5.83333 7.7 7.7 5.83333 10 5.83333C12.3 5.83333 14.1667 7.7 14.1667 10C14.1667 12.3 12.3 14.1667 10 14.1667ZM10 7.5C8.625 7.5 7.5 8.625 7.5 10C7.5 11.375 8.625 12.5 10 12.5C11.375 12.5 12.5 11.375 12.5 10C12.5 8.625 11.375 7.5 10 7.5ZM10.8333 3.33333V0.833333C10.8333 0.375 10.4583 0 10 0C9.54167 0 9.16667 0.375 9.16667 0.833333V3.33333C9.16667 3.79167 9.54167 4.16667 10 4.16667C10.4583 4.16667 10.8333 3.79167 10.8333 3.33333ZM10.8333 19.1667V16.6667C10.8333 16.2083 10.4583 15.8333 10 15.8333C9.54167 15.8333 9.16667 16.2083 9.16667 16.6667V19.1667C9.16667 19.625 9.54167 20 10 20C10.4583 20 10.8333 19.625 10.8333 19.1667ZM4.16667 10C4.16667 9.54167 3.79167 9.16667 3.33333 9.16667H0.833333C0.375 9.16667 0 9.54167 0 10C0 10.4583 0.375 10.8333 0.833333 10.8333H3.33333C3.79167 10.8333 4.16667 10.4583 4.16667 10ZM20 10C20 9.54167 19.625 9.16667 19.1667 9.16667H16.6667C16.2083 9.16667 15.8333 9.54167 15.8333 10C15.8333 10.4583 16.2083 10.8333 16.6667 10.8333H19.1667C19.625 10.8333 20 10.4583 20 10ZM5.59167 5.59167C5.91667 5.26667 5.91667 4.74167 5.59167 4.41667L3.925 2.75C3.6 2.425 3.075 2.425 2.75 2.75C2.425 3.075 2.425 3.6 2.75 3.925L4.41667 5.59167C4.58333 5.75833 4.79167 5.83333 5.00833 5.83333C5.225 5.83333 5.43333 5.75 5.6 5.59167H5.59167ZM17.2583 17.2583C17.5833 16.9333 17.5833 16.4083 17.2583 16.0833L15.5917 14.4167C15.2667 14.0917 14.7417 14.0917 14.4167 14.4167C14.0917 14.7417 14.0917 15.2667 14.4167 15.5917L16.0833 17.2583C16.25 17.425 16.4583 17.5 16.675 17.5C16.8917 17.5 17.1 17.4167 17.2667 17.2583H17.2583ZM3.925 17.2583L5.59167 15.5917C5.91667 15.2667 5.91667 14.7417 5.59167 14.4167C5.26667 14.0917 4.74167 14.0917 4.41667 14.4167L2.75 16.0833C2.425 16.4083 2.425 16.9333 2.75 17.2583C2.91667 17.425 3.125 17.5 3.34167 17.5C3.55833 17.5 3.76667 17.4167 3.93333 17.2583H3.925ZM15.5917 5.59167L17.2583 3.925C17.5833 3.6 17.5833 3.075 17.2583 2.75C16.9333 2.425 16.4083 2.425 16.0833 2.75L14.4167 4.41667C14.0917 4.74167 14.0917 5.26667 14.4167 5.59167C14.5833 5.75833 14.7917 5.83333 15.0083 5.83333C15.225 5.83333 15.4333 5.75 15.6 5.59167H15.5917Z" />
              </svg>
            </Button>
            <Button
              variant="ghost"
              size="1"
              onClick={() => themeContext.changeTheme("dark")}
              className={`p-2.5 rounded-md ${
                themeContext.theme === "dark" ? "bg-secondarySurface-dark" : ""
              }`}
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
                className="text-gray-light dark:text-gray-dark"
                fill="currentColor"
              >
                <path d="M10.0075 19.9999C8.60714 19.9916 7.22397 19.6908 5.94659 19.1168C4.66922 18.5429 3.5258 17.7085 2.58958 16.6671C1.65335 15.6257 0.94497 14.4002 0.509804 13.0691C0.0746374 11.7381 -0.077718 10.3308 0.0624964 8.93745C0.311639 6.7617 1.26115 4.72586 2.76796 3.13668C4.27477 1.54751 6.25724 0.491093 8.41666 0.126615C9.81172 -0.0898286 11.2356 -0.0315131 12.6083 0.298282C12.9698 0.391053 13.2997 0.579203 13.5635 0.84307C13.8274 1.10694 14.0156 1.43683 14.1083 1.79828C14.2018 2.15645 14.1969 2.53319 14.0943 2.88883C13.9916 3.24448 13.795 3.56585 13.525 3.81912C9.72583 7.29245 10.0542 12.6899 14.1975 15.8291C14.4902 16.059 14.7159 16.3632 14.8513 16.7099C14.9866 17.0566 15.0265 17.4333 14.967 17.8007C14.9074 18.1681 14.7506 18.5128 14.5126 18.7991C14.2747 19.0853 13.9645 19.3026 13.6142 19.4283C12.4498 19.8087 11.2324 20.0016 10.0075 19.9999ZM10.0692 1.66662C9.60184 1.66552 9.13515 1.7009 8.67333 1.77245C6.87666 2.07727 5.22745 2.957 3.97357 4.2794C2.71969 5.6018 1.92888 7.29544 1.72 9.10578C1.59005 10.2725 1.70988 11.4535 2.07152 12.5703C2.43317 13.6871 3.02834 14.7142 3.8175 15.5833C4.97229 16.8173 6.46055 17.6896 8.10155 18.094C9.74254 18.4984 11.4657 18.4177 13.0617 17.8616C13.1302 17.8357 13.1907 17.7921 13.237 17.7354C13.2834 17.6786 13.3139 17.6106 13.3256 17.5382C13.3372 17.4659 13.3296 17.3917 13.3035 17.3233C13.2773 17.2548 13.2336 17.1944 13.1767 17.1483C8.23583 13.4166 7.8475 6.73912 12.3875 2.60328C12.4393 2.55486 12.4767 2.49297 12.4954 2.42454C12.5141 2.35611 12.5134 2.28383 12.4933 2.21578C12.4761 2.14324 12.4393 2.07679 12.387 2.02363C12.3347 1.97046 12.2689 1.93259 12.1967 1.91412C11.5 1.74627 10.7857 1.66317 10.0692 1.66662ZM17.0833 9.99995C16.8976 9.99994 16.7171 9.93786 16.5707 9.82357C16.4242 9.70928 16.3201 9.54932 16.275 9.36912L15.9767 8.17745L14.7833 7.85662C14.6039 7.80831 14.4457 7.70139 14.334 7.55286C14.2223 7.40433 14.1634 7.22272 14.1667 7.0369C14.1701 6.85107 14.2355 6.6717 14.3525 6.5273C14.4695 6.3829 14.6314 6.28175 14.8125 6.23995L15.9792 5.96912L16.2717 4.79745C16.3168 4.61726 16.4209 4.45733 16.5673 4.34305C16.7138 4.22877 16.8942 4.1667 17.08 4.1667C17.2658 4.1667 17.4462 4.22877 17.5926 4.34305C17.7391 4.45733 17.8432 4.61726 17.8883 4.79745L18.1842 5.97912L19.3658 6.27495C19.546 6.32011 19.706 6.42418 19.8202 6.57063C19.9345 6.71708 19.9966 6.89752 19.9966 7.08328C19.9966 7.26904 19.9345 7.44948 19.8202 7.59593C19.706 7.74239 19.546 7.84646 19.3658 7.89162L18.1842 8.18745L17.8883 9.36912C17.8433 9.54877 17.7398 9.70831 17.594 9.82255C17.4482 9.93678 17.2685 9.9992 17.0833 9.99995ZM13.3333 11.6666C13.3333 11.8876 13.4211 12.0996 13.5774 12.2559C13.7337 12.4122 13.9456 12.4999 14.1667 12.4999C14.3877 12.4999 14.5996 12.4122 14.7559 12.2559C14.9122 12.0996 15 11.8876 15 11.6666C15 11.4456 14.9122 11.2336 14.7559 11.0774C14.5996 10.9211 14.3877 10.8333 14.1667 10.8333C13.9456 10.8333 13.7337 10.9211 13.5774 11.0774C13.4211 11.2336 13.3333 11.4456 13.3333 11.6666ZM18.3333 14.9999C18.3333 15.221 18.4211 15.4329 18.5774 15.5892C18.7337 15.7455 18.9457 15.8333 19.1667 15.8333C19.3877 15.8333 19.5996 15.7455 19.7559 15.5892C19.9122 15.4329 20 15.221 20 14.9999C20 14.7789 19.9122 14.567 19.7559 14.4107C19.5996 14.2544 19.3877 14.1666 19.1667 14.1666C18.9457 14.1666 18.7337 14.2544 18.5774 14.4107C18.4211 14.567 18.3333 14.7789 18.3333 14.9999Z" />
              </svg>
            </Button>
          </div>
        </div>
        <div className="relative grow bg-secondaryBackground-light dark:bg-secondaryBackground-dark rounded-xl rounded-t-none border-t border-t-gray-300 dark:border-t-gray-700 overflow-hidden">
          {props.graphSlot}
        </div>
      </div>
    </div>
  );
}
