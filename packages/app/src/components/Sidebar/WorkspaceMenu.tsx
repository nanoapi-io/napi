import { DropdownMenu } from '@radix-ui/themes';
import { useEffect, useState, useContext } from 'react';
import { StoreContext } from '../../contexts/StoreContext';
import { useNavigate } from 'react-router';
// import { NewWorkspaceDialog } from './NewWorkspaceDialog';

export default function WorkspaceMenu() {
  const navigate = useNavigate();
  const stateContext = useContext(StoreContext);
  const [workspaces, setWorkspaces] = useState([{
    id: '1',
    name: 'Default'
  }]);

  const isActiveWorkspace = (workspace: any) => {
    const activeWorkspace = stateContext.state.activeWorkspace;
    console.log(activeWorkspace, workspace.id);
    return activeWorkspace && workspace.id === activeWorkspace.id;
  }

  const setActiveWorkspace = (workspace: any) => {
    stateContext.changeState({ activeWorkspace: workspace });
    localStorage.setItem('activeWorkspaceId', workspace.id);
    navigate('/projects');
  }

  useEffect(() => {
    const userData = stateContext.state.user;
    console.log(stateContext.state);
    if (userData) {
      setWorkspaces(userData.workspaces);
    }
  }, [stateContext.state.user]);

  return (
    <>
      <DropdownMenu.Root>
        <DropdownMenu.Trigger>
          <button className={`mt-auto flex gap-x-2 p-2 rounded-lg  text-gray-light dark:text-gray-dark bg-search-bgLight dark:bg-search-bgDark px-3 py-2.5 mb-2 border-[1px] border-search-bgLight dark:border-search-bgDark hover:bg-hover-dark dark:hover:bg-hover-light transition-all`}>
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M5 4C4.73478 4 4.48043 4.10536 4.29289 4.29289C4.10536 4.48043 4 4.73478 4 5V19C4 19.2652 4.10536 19.5196 4.29289 19.7071C4.48043 19.8946 4.73478 20 5 20H9C9.55228 20 10 20.4477 10 21C10 21.5523 9.55228 22 9 22H5C4.20435 22 3.44129 21.6839 2.87868 21.1213C2.31607 20.5587 2 19.7956 2 19V5C2 4.20435 2.31607 3.44129 2.87868 2.87868C3.44129 2.31607 4.20435 2 5 2H9C9.55228 2 10 2.44772 10 3C10 3.55228 9.55228 4 9 4H5Z" fill="currentColor"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M15.2929 6.29289C15.6834 5.90237 16.3166 5.90237 16.7071 6.29289L21.7071 11.2929C22.0976 11.6834 22.0976 12.3166 21.7071 12.7071L16.7071 17.7071C16.3166 18.0976 15.6834 18.0976 15.2929 17.7071C14.9024 17.3166 14.9024 16.6834 15.2929 16.2929L19.5858 12L15.2929 7.70711C14.9024 7.31658 14.9024 6.68342 15.2929 6.29289Z" fill="currentColor"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M8 12C8 11.4477 8.44772 11 9 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H9C8.44772 13 8 12.5523 8 12Z" fill="currentColor"/>
            </svg>
            <p className="text-md">Switch workspace</p>
          </button>
        </DropdownMenu.Trigger>
        <DropdownMenu.Content variant='soft' className='bg-foreground-light dark:bg-foreground-dark mt-1.5'>
          {workspaces.map((workspace: any) => (
            <DropdownMenu.Item key={workspace.id} className='hover:bg-hover-dark'>
              <button 
                onClick={() => setActiveWorkspace(workspace)}
                className='w-full text-left text-lg flex justify-between my-1'>
                <p>{workspace.name}</p>
                {true && (
                  <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className='my-auto'>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12 6C12.5523 6 13 6.44772 13 7V21C13 21.5523 12.5523 22 12 22C11.4477 22 11 21.5523 11 21V7C11 6.44772 11.4477 6 12 6Z" fill="currentColor"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M22.7071 9.29289C23.0976 9.68342 23.0976 10.3166 22.7071 10.7071L18.7071 14.7071C18.3166 15.0976 17.6834 15.0976 17.2929 14.7071L15.2929 12.7071C14.9024 12.3166 14.9024 11.6834 15.2929 11.2929C15.6834 10.9024 16.3166 10.9024 16.7071 11.2929L18 12.5858L21.2929 9.29289C21.6834 8.90237 22.3166 8.90237 22.7071 9.29289Z" fill="currentColor"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M1.58579 2.58579C1.96086 2.21071 2.46957 2 3 2H8C9.32608 2 10.5979 2.52678 11.5355 3.46447C11.7038 3.63274 11.8589 3.81178 12 3.99997C12.1411 3.81178 12.2962 3.63274 12.4645 3.46447C13.4021 2.52678 14.6739 2 16 2H21C21.5304 2 22.0391 2.21071 22.4142 2.58579C22.7893 2.96086 23 3.46957 23 4V6C23 6.55228 22.5523 7 22 7C21.4477 7 21 6.55228 21 6V4H16C15.2044 4 14.4413 4.31607 13.8787 4.87868C13.3161 5.44129 13 6.20435 13 7C13 7.55228 12.5523 8 12 8C11.4477 8 11 7.55228 11 7C11 6.20435 10.6839 5.44129 10.1213 4.87868C9.55871 4.31607 8.79565 4 8 4H3V17H9C10.0609 17 11.0783 17.4214 11.8284 18.1716C11.8877 18.2308 11.9449 18.2918 12 18.3542C12.0551 18.2918 12.1123 18.2308 12.1716 18.1716C12.9217 17.4214 13.9391 17 15 17H21V15.7C21 15.1477 21.4477 14.7 22 14.7C22.5523 14.7 23 15.1477 23 15.7V17C23 17.5304 22.7893 18.0391 22.4142 18.4142C22.0391 18.7893 21.5304 19 21 19H15C14.4696 19 13.9609 19.2107 13.5858 19.5858C13.2107 19.9609 13 20.4696 13 21C13 21.5523 12.5523 22 12 22C11.4477 22 11 21.5523 11 21C11 20.4696 10.7893 19.9609 10.4142 19.5858C10.0391 19.2107 9.53043 19 9 19H3C2.46957 19 1.96086 18.7893 1.58579 18.4142C1.21071 18.0391 1 17.5304 1 17V4C1 3.46957 1.21071 2.96086 1.58579 2.58579Z" fill="currentColor"/>
                  </svg>
                  )}
              </button>
            </DropdownMenu.Item>
          ))}
          <DropdownMenu.Separator />
          <DropdownMenu.Item className='hover:bg-hover-dark'>
            <button className='w-full flex align-middle text-text-gray text-md gap-x-1' onClick={(() => navigate('/workspaces'))}>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" className='my-auto'>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M11 7C8.79086 7 7 8.79086 7 11C7 13.2091 8.79086 15 11 15C13.2091 15 15 13.2091 15 11C15 8.79086 13.2091 7 11 7ZM9 11C9 9.89543 9.89543 9 11 9C12.1046 9 13 9.89543 13 11C13 12.1046 12.1046 13 11 13C9.89543 13 9 12.1046 9 11Z" fill="currentColor"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.78 0C9.98435 0 9.22129 0.31607 8.65868 0.87868C8.09608 1.44129 7.78 2.20435 7.78 3L7.78 3.17897C7.77974 3.35417 7.73345 3.52671 7.64577 3.67839C7.55801 3.83022 7.43187 3.95629 7.28 4.04397L7.27738 4.04549L6.85 4.29397L6.84894 4.29459C6.69718 4.38196 6.52513 4.42795 6.35 4.42795C6.17447 4.42795 6.00202 4.38174 5.85 4.29397C5.84029 4.28837 5.83049 4.28292 5.82059 4.27765L5.68379 4.20468C4.99871 3.81504 4.18754 3.71053 3.42568 3.91425C2.65793 4.11955 2.00301 4.62109 1.60468 5.30879L1.38379 5.69032C0.986686 6.37873 0.878957 7.19657 1.08425 7.96432C1.28656 8.7209 1.77655 9.3679 2.44887 9.76776L2.5753 9.85205C2.59317 9.86396 2.61142 9.8753 2.63002 9.88604C2.78116 9.97329 2.90683 10.0986 2.99455 10.2495C3.08184 10.3996 3.12852 10.5699 3.13 10.7435V11.25L3.13001 11.254C3.13071 11.4302 3.08484 11.6034 2.99703 11.7562C2.90923 11.909 2.78262 12.0359 2.63001 12.124L2.61551 12.1325L2.47148 12.2189C1.78754 12.6177 1.28882 13.2706 1.08425 14.0357C0.878957 14.8034 0.986686 15.6213 1.38379 16.3097L1.60468 16.6912C2.00301 17.3789 2.65793 17.8805 3.42568 18.0858C4.18753 18.2895 4.9987 18.185 5.68377 17.7953L5.82059 17.7224C5.83049 17.7171 5.84029 17.7116 5.85 17.706C6.00202 17.6183 6.17447 17.5721 6.35 17.5721C6.52513 17.5721 6.69718 17.618 6.84894 17.7054L6.85 17.706L7.27738 17.9545L7.28 17.956C7.43187 18.0437 7.55801 18.1698 7.64577 18.3216C7.73345 18.4733 7.77974 18.6453 7.78 18.8205V19C7.78 19.7957 8.09608 20.5587 8.65868 21.1213C9.22129 21.6839 9.98435 22 10.78 22H11.22C12.0157 22 12.7787 21.6839 13.3413 21.1213C13.9039 20.5587 14.22 19.7957 14.22 19L14.22 18.821C14.2203 18.646 14.2666 18.4732 14.3542 18.3216C14.442 18.1698 14.5681 18.0437 14.72 17.956L14.7215 17.9552L15.15 17.706L15.1511 17.7054C15.3028 17.618 15.4749 17.5721 15.65 17.5721C15.8255 17.5721 15.998 17.6183 16.15 17.706C16.1597 17.7116 16.1695 17.7171 16.1794 17.7224L16.3162 17.7953C17.0013 18.185 17.8125 18.2895 18.5743 18.0858C19.3421 17.8805 19.997 17.3789 20.3953 16.6912L20.401 16.6813L20.6188 16.2951C21.0138 15.6077 21.1206 14.7917 20.9158 14.0257C20.7105 13.2579 20.2089 12.603 19.5212 12.2047C19.5111 12.1988 19.5009 12.1931 19.4906 12.1876L19.358 12.1169C19.2107 12.0292 19.0885 11.905 19.003 11.7562C18.9152 11.6034 18.8693 11.4302 18.87 11.254L18.87 11.25V10.75L18.87 10.746C18.8693 10.5698 18.9152 10.3966 19.003 10.2438C19.0908 10.091 19.2174 9.96414 19.37 9.87603L19.3845 9.86749L19.5286 9.78105C20.2125 9.38232 20.7112 8.72933 20.9158 7.96432C21.121 7.19657 21.0133 6.37873 20.6162 5.69032L20.3953 5.30879C19.997 4.62109 19.3421 4.11955 18.5743 3.91425C17.8125 3.71053 17.0013 3.81504 16.3162 4.20468L16.1794 4.27765C16.1695 4.28292 16.1597 4.28837 16.15 4.29397C15.998 4.38174 15.8255 4.42795 15.65 4.42795C15.4749 4.42795 15.3028 4.38196 15.1511 4.29459L15.15 4.29397L14.7226 4.04549L14.72 4.04397C14.5681 3.95629 14.442 3.83022 14.3542 3.67839C14.2666 3.52681 14.2203 3.35489 14.22 3.17982V3C14.22 2.20435 13.9039 1.44129 13.3413 0.87868C12.7787 0.31607 12.0157 0 11.22 0H10.78ZM10.0729 2.29289C10.2604 2.10536 10.5148 2 10.78 2H11.22C11.4852 2 11.7396 2.10536 11.9271 2.29289C12.1146 2.48043 12.22 2.73478 12.22 3V3.18103C12.2205 3.70711 12.3594 4.22381 12.6227 4.67928C12.8857 5.13431 13.2637 5.51225 13.7187 5.77526L13.72 5.77603L14.1474 6.02451L14.15 6.02603C14.6061 6.28933 15.1234 6.42795 15.65 6.42795C16.1704 6.42795 16.6818 6.29256 17.1339 6.03524L17.2706 5.96235C17.2804 5.95713 17.2901 5.95175 17.2997 5.94621C17.5291 5.81384 17.8018 5.77793 18.0577 5.84637C18.3135 5.91478 18.5318 6.08189 18.6646 6.31104L18.8838 6.68968C19.016 6.91907 19.052 7.19188 18.9836 7.44768C18.9152 7.70359 18.748 7.9219 18.5188 8.05468L18.5055 8.06251L18.362 8.14862C17.9078 8.41273 17.5308 8.79155 17.2689 9.24721C17.0059 9.70485 16.8683 10.2238 16.87 10.7516V11.2484C16.8683 11.7762 17.0059 12.2951 17.2689 12.7528C17.5324 13.2111 17.9122 13.5917 18.37 13.856C18.3797 13.8616 18.3895 13.8671 18.3994 13.8724L18.5313 13.9427C18.7541 14.0761 18.9165 14.2911 18.9836 14.5423C19.0521 14.7982 19.0162 15.0709 18.8838 15.3003L18.879 15.3087L18.6623 15.6929C18.5293 15.92 18.3121 16.0856 18.0577 16.1536C17.8018 16.2221 17.5291 16.1862 17.2997 16.0538C17.2901 16.0482 17.2804 16.0429 17.2706 16.0376L17.1339 15.9648C16.6818 15.7074 16.1704 15.572 15.65 15.572C15.1234 15.572 14.6061 15.7107 14.15 15.974L14.1474 15.9755L13.72 16.224L13.7186 16.2248C13.2636 16.4878 12.8857 16.8657 12.6227 17.3207C12.3594 17.7762 12.2205 18.2929 12.22 18.819V19C12.22 19.2652 12.1146 19.5196 11.9271 19.7071C11.7396 19.8946 11.4852 20 11.22 20H10.78C10.5148 20 10.2604 19.8946 10.0729 19.7071C9.88536 19.5196 9.78 19.2652 9.78 19L9.78 18.819C9.77946 18.2929 9.64059 17.7762 9.37731 17.3207C9.11433 16.8658 8.73645 16.4879 8.28152 16.2249L8.28 16.224L7.85129 15.9747L7.85 15.974C7.39395 15.7107 6.87662 15.572 6.35 15.572C5.82957 15.572 5.3182 15.7074 4.86608 15.9648L4.72942 16.0376C4.71963 16.0429 4.70993 16.0482 4.70033 16.0538C4.47086 16.1862 4.19825 16.2221 3.94233 16.1536C3.68648 16.0852 3.46822 15.9181 3.33543 15.689L3.11622 15.3103C2.98414 15.081 2.948 14.808 3.01637 14.5523C3.0848 14.2964 3.25198 14.0781 3.48122 13.9453L3.4945 13.9375L3.63799 13.8514C4.09223 13.5873 4.46919 13.2085 4.73106 12.7528C4.99411 12.2951 5.13171 11.7761 5.13 11.2482V10.74L5.12999 10.734C5.12683 10.2104 4.98671 9.69682 4.72356 9.24421C4.46636 8.80182 4.10038 8.43275 3.6606 8.17188L3.53471 8.08795C3.51723 8.0763 3.49939 8.0652 3.48122 8.05468C3.25198 7.9219 3.0848 7.70359 3.01637 7.44768C2.948 7.19197 2.98379 6.91959 3.11589 6.69024L3.33533 6.31121C3.46811 6.08207 3.68648 5.91478 3.94233 5.84637C4.19825 5.77793 4.47086 5.81384 4.70033 5.94621C4.70993 5.95175 4.71963 5.95713 4.72942 5.96235L4.86607 6.03524C5.3182 6.29256 5.82957 6.42795 6.35 6.42795C6.87661 6.42795 7.39395 6.28933 7.85 6.02603L7.85263 6.02451L8.28 5.77603L8.28143 5.7752C8.7364 5.51219 9.11431 5.13428 9.37731 4.67928C9.64059 4.22381 9.77946 3.70711 9.78 3.18103L9.78 3C9.78 2.73478 9.88536 2.48043 10.0729 2.29289Z" fill="currentColor"/>
              </svg>
              Manage Workspaces
            </button>
          </DropdownMenu.Item>
        </DropdownMenu.Content>
      </DropdownMenu.Root>
    </>
  )
}